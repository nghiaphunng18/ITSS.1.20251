{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/nghiaphunng18/HustTutorial/ITSS.1.20251/components/features/interactive-slides/PDFMainViewer.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState, useRef } from \"react\";\nimport { Document, Page, pdfjs } from \"react-pdf\";\nimport { ZoomIn, ZoomOut, RefreshCw } from \"lucide-react\"; // Import icon\n\n// Import CSS\nimport \"react-pdf/dist/Page/AnnotationLayer.css\";\nimport \"react-pdf/dist/Page/TextLayer.css\";\n\nif (typeof window !== \"undefined\") {\n  pdfjs.GlobalWorkerOptions.workerSrc = \"/pdf.worker.min.mjs\";\n}\n\ninterface Props {\n  fileUrl: string;\n  currPage: number;\n  onLoadSuccess: (total: number) => void;\n}\n\nexport default function PDFMainViewer({\n  fileUrl,\n  currPage,\n  onLoadSuccess,\n}: Props) {\n  const [scale, setScale] = useState(1.2); // Mặc định 120%\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  // Xử lý Ctrl + Scroll để zoom\n  useEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n\n    const handleWheel = (e: WheelEvent) => {\n      if (e.ctrlKey) {\n        e.preventDefault();\n        const delta = e.deltaY * -0.01;\n        setScale((prev) => Math.min(Math.max(0.5, prev + delta), 3.0)); // Limit 50% -> 300%\n      }\n    };\n\n    // Phải add native event listener với { passive: false } để preventDefault được\n    container.addEventListener(\"wheel\", handleWheel, { passive: false });\n\n    return () => {\n      container.removeEventListener(\"wheel\", handleWheel);\n    };\n  }, []);\n\n  // Các hàm tiện ích\n  const zoomIn = () => setScale((s) => Math.min(s + 0.2, 3.0));\n  const zoomOut = () => setScale((s) => Math.max(s - 0.2, 0.5));\n  const resetZoom = () => setScale(1.2);\n\n  return (\n    <div className=\"relative h-full flex flex-col group\">\n      {/* Container chính */}\n      <div\n        ref={containerRef}\n        className=\"flex-1 flex justify-center bg-gray-200 border rounded-lg overflow-auto shadow-inner p-4 custom-scrollbar relative\"\n      >\n        <Document\n          file={fileUrl}\n          onLoadSuccess={({ numPages }) => onLoadSuccess(numPages)}\n          loading={\n            <div className=\"flex items-center justify-center h-96 text-gray-500 gap-2\">\n              <span className=\"animate-spin h-5 w-5 border-2 border-gray-400 border-t-transparent rounded-full\" />\n              <span className=\"animate-pulse\">Đang tải tài liệu...</span>\n            </div>\n          }\n          error={\n            <div className=\"flex flex-col items-center justify-center h-96 text-red-500 gap-2 p-4 text-center\">\n              <p className=\"font-medium\">⚠ Không thể tải file PDF</p>\n              <p className=\"text-sm text-gray-500\">\n                Vui lòng kiểm tra lại đường dẫn hoặc định dạng file.\n              </p>\n            </div>\n          }\n          className=\"shadow-lg\"\n        >\n          <Page\n            pageNumber={currPage}\n            scale={scale} // Truyền scale vào đây\n            renderAnnotationLayer={false}\n            renderTextLayer={false}\n            className=\"bg-white transition-transform duration-200 ease-in-out\" // Thêm transition cho mượt\n            loading={\n              <div\n                className=\"bg-white animate-pulse\"\n                style={{\n                  width: `${600 * scale}px`,\n                  height: `${800 * scale}px`,\n                }}\n              />\n            }\n          />\n        </Document>\n      </div>\n\n      {/* Floating Toolbar (Thanh công cụ nổi) */}\n      <div className=\"absolute bottom-6 left-1/2 -translate-x-1/2 flex items-center gap-2 bg-black/75 backdrop-blur-sm text-white px-3 py-2 rounded-full shadow-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300\">\n        <button\n          onClick={zoomOut}\n          className=\"p-1.5 hover:bg-white/20 rounded-full transition\"\n          title=\"Thu nhỏ (Ctrl -)\"\n        >\n          <ZoomOut size={18} />\n        </button>\n        <span className=\"text-xs font-medium w-12 text-center select-none\">\n          {Math.round(scale * 100)}%\n        </span>\n        <button\n          onClick={zoomIn}\n          className=\"p-1.5 hover:bg-white/20 rounded-full transition\"\n          title=\"Phóng to (Ctrl +)\"\n        >\n          <ZoomIn size={18} />\n        </button>\n        <div className=\"w-px h-4 bg-white/20 mx-1\"></div>\n        <button\n          onClick={resetZoom}\n          className=\"p-1.5 hover:bg-white/20 rounded-full transition\"\n          title=\"Đặt lại (Reset)\"\n        >\n          <RefreshCw size={16} />\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AACA,mWAA2D,cAAc;AAAzE;AAAA;;;AAJA;;;;;;AAUA,wCAAmC;IACjC,2LAAK,CAAC,mBAAmB,CAAC,SAAS,GAAG;AACxC;AAQe,SAAS,cAAc,EACpC,OAAO,EACP,QAAQ,EACR,aAAa,EACP;;IACN,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC,MAAM,gBAAgB;IACzD,MAAM,eAAe,IAAA,uKAAM,EAAiB;IAE5C,8BAA8B;IAC9B,IAAA,0KAAS;mCAAC;YACR,MAAM,YAAY,aAAa,OAAO;YACtC,IAAI,CAAC,WAAW;YAEhB,MAAM;uDAAc,CAAC;oBACnB,IAAI,EAAE,OAAO,EAAE;wBACb,EAAE,cAAc;wBAChB,MAAM,QAAQ,EAAE,MAAM,GAAG,CAAC;wBAC1B;mEAAS,CAAC,OAAS,KAAK,GAAG,CAAC,KAAK,GAAG,CAAC,KAAK,OAAO,QAAQ;mEAAO,oBAAoB;oBACtF;gBACF;;YAEA,+EAA+E;YAC/E,UAAU,gBAAgB,CAAC,SAAS,aAAa;gBAAE,SAAS;YAAM;YAElE;2CAAO;oBACL,UAAU,mBAAmB,CAAC,SAAS;gBACzC;;QACF;kCAAG,EAAE;IAEL,mBAAmB;IACnB,MAAM,SAAS,IAAM,SAAS,CAAC,IAAM,KAAK,GAAG,CAAC,IAAI,KAAK;IACvD,MAAM,UAAU,IAAM,SAAS,CAAC,IAAM,KAAK,GAAG,CAAC,IAAI,KAAK;IACxD,MAAM,YAAY,IAAM,SAAS;IAEjC,qBACE,6LAAC;QAAI,WAAU;;0BAEb,6LAAC;gBACC,KAAK;gBACL,WAAU;0BAEV,cAAA,6LAAC,sMAAQ;oBACP,MAAM;oBACN,eAAe,CAAC,EAAE,QAAQ,EAAE,GAAK,cAAc;oBAC/C,uBACE,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAK,WAAU;;;;;;0CAChB,6LAAC;gCAAK,WAAU;0CAAgB;;;;;;;;;;;;oBAGpC,qBACE,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAE,WAAU;0CAAc;;;;;;0CAC3B,6LAAC;gCAAE,WAAU;0CAAwB;;;;;;;;;;;;oBAKzC,WAAU;8BAEV,cAAA,6LAAC,0LAAI;wBACH,YAAY;wBACZ,OAAO;wBACP,uBAAuB;wBACvB,iBAAiB;wBACjB,WAAU;wBACV,uBACE,6LAAC;4BACC,WAAU;4BACV,OAAO;gCACL,OAAO,GAAG,MAAM,MAAM,EAAE,CAAC;gCACzB,QAAQ,GAAG,MAAM,MAAM,EAAE,CAAC;4BAC5B;;;;;;;;;;;;;;;;;;;;;0BAQV,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBACC,SAAS;wBACT,WAAU;wBACV,OAAM;kCAEN,cAAA,6LAAC,0NAAO;4BAAC,MAAM;;;;;;;;;;;kCAEjB,6LAAC;wBAAK,WAAU;;4BACb,KAAK,KAAK,CAAC,QAAQ;4BAAK;;;;;;;kCAE3B,6LAAC;wBACC,SAAS;wBACT,WAAU;wBACV,OAAM;kCAEN,cAAA,6LAAC,uNAAM;4BAAC,MAAM;;;;;;;;;;;kCAEhB,6LAAC;wBAAI,WAAU;;;;;;kCACf,6LAAC;wBACC,SAAS;wBACT,WAAU;wBACV,OAAM;kCAEN,cAAA,6LAAC,gOAAS;4BAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;;AAK3B;GA7GwB;KAAA","debugId":null}}]
}