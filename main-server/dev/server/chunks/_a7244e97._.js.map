{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":["file:///home/nghiaphunng18/HustTutorial/ITSS.1.20251/lib/prisma.ts"],"sourcesContent":["import \"dotenv/config\";\nimport { PrismaPg } from '@prisma/adapter-pg'\nimport { PrismaClient } from '../prisma/generated/client';\n\nconst connectionString = `${process.env.POSTGRES_URL}`\n\nconst adapter = new PrismaPg({ connectionString })\nconst prisma = new PrismaClient({ adapter })\n\nexport { prisma }"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;AAEA,MAAM,mBAAmB,GAAG,QAAQ,GAAG,CAAC,YAAY,EAAE;AAEtD,MAAM,UAAU,IAAI,yKAAQ,CAAC;IAAE;AAAiB;AAChD,MAAM,SAAS,IAAI,wJAAY,CAAC;IAAE;AAAQ","debugId":null}},
    {"offset": {"line": 35, "column": 0}, "map": {"version":3,"sources":["file:///home/nghiaphunng18/HustTutorial/ITSS.1.20251/app/api/notifications/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { prisma } from \"@/lib/prisma\";\n\n// GET /api/notifications - Get user's notifications\nexport async function GET(request: Request) {\n  try {\n    const { searchParams } = new URL(request.url);\n    const userId = searchParams.get(\"userId\");\n    const unreadOnly = searchParams.get(\"unreadOnly\") === \"true\";\n\n    if (!userId) {\n      return NextResponse.json(\n        { error: \"userId is required\" },\n        { status: 400 }\n      );\n    }\n\n    const notifications = await prisma.notification.findMany({\n      where: {\n        userId,\n        ...(unreadOnly ? { read: false } : {}),\n      },\n      include: {\n        category: true,\n      },\n      orderBy: {\n        createdAt: \"desc\",\n      },\n      take: 50, // Limit to 50 most recent\n    });\n\n    return NextResponse.json(notifications);\n  } catch (error) {\n    console.error(\"Failed to fetch notifications:\", error);\n    return NextResponse.json(\n      { error: \"Failed to fetch notifications\" },\n      { status: 500 }\n    );\n  }\n}\n\n// POST /api/notifications - Create a new notification\nexport async function POST(request: Request) {\n  try {\n    const body = await request.json();\n    const { userId, categoryCode, title, message, link, priority, metadata } =\n      body;\n\n    if (!userId || !categoryCode || !title || !message) {\n      return NextResponse.json(\n        { error: \"Missing required fields\" },\n        { status: 400 }\n      );\n    }\n\n    // Find or create category\n    let category = await prisma.notificationCategory.findUnique({\n      where: { code: categoryCode },\n    });\n\n    if (!category) {\n      // Create default category if it doesn't exist\n      category = await prisma.notificationCategory.create({\n        data: {\n          code: categoryCode,\n          name: categoryCode.replace(/_/g, \" \"),\n          priority: priority || \"NORMAL\",\n        },\n      });\n    }\n\n    const notification = await prisma.notification.create({\n      data: {\n        userId,\n        categoryId: category.id,\n        title,\n        message,\n        link,\n        priority: priority || \"NORMAL\",\n        metadata,\n      },\n      include: {\n        category: true,\n      },\n    });\n\n    return NextResponse.json(notification, { status: 201 });\n  } catch (error) {\n    console.error(\"Failed to create notification:\", error);\n    return NextResponse.json(\n      { error: \"Failed to create notification\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;;;;;AAGO,eAAe,IAAI,OAAgB;IACxC,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,SAAS,aAAa,GAAG,CAAC;QAChC,MAAM,aAAa,aAAa,GAAG,CAAC,kBAAkB;QAEtD,IAAI,CAAC,QAAQ;YACX,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAqB,GAC9B;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,gBAAgB,MAAM,yHAAM,CAAC,YAAY,CAAC,QAAQ,CAAC;YACvD,OAAO;gBACL;gBACA,GAAI,aAAa;oBAAE,MAAM;gBAAM,IAAI,CAAC,CAAC;YACvC;YACA,SAAS;gBACP,UAAU;YACZ;YACA,SAAS;gBACP,WAAW;YACb;YACA,MAAM;QACR;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC;QAChD,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAgC,GACzC;YAAE,QAAQ;QAAI;IAElB;AACF;AAGO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,MAAM,EAAE,YAAY,EAAE,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,QAAQ,EAAE,GACtE;QAEF,IAAI,CAAC,UAAU,CAAC,gBAAgB,CAAC,SAAS,CAAC,SAAS;YAClD,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA0B,GACnC;gBAAE,QAAQ;YAAI;QAElB;QAEA,0BAA0B;QAC1B,IAAI,WAAW,MAAM,yHAAM,CAAC,oBAAoB,CAAC,UAAU,CAAC;YAC1D,OAAO;gBAAE,MAAM;YAAa;QAC9B;QAEA,IAAI,CAAC,UAAU;YACb,8CAA8C;YAC9C,WAAW,MAAM,yHAAM,CAAC,oBAAoB,CAAC,MAAM,CAAC;gBAClD,MAAM;oBACJ,MAAM;oBACN,MAAM,aAAa,OAAO,CAAC,MAAM;oBACjC,UAAU,YAAY;gBACxB;YACF;QACF;QAEA,MAAM,eAAe,MAAM,yHAAM,CAAC,YAAY,CAAC,MAAM,CAAC;YACpD,MAAM;gBACJ;gBACA,YAAY,SAAS,EAAE;gBACvB;gBACA;gBACA;gBACA,UAAU,YAAY;gBACtB;YACF;YACA,SAAS;gBACP,UAAU;YACZ;QACF;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC,cAAc;YAAE,QAAQ;QAAI;IACvD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC;QAChD,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAgC,GACzC;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}